<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>纯前端导出excel(支持多sheet页及表格样式表格合并)</title>
      <link href="2022/050351906.html"/>
      <url>2022/050351906.html</url>
      
        <content type="html"><![CDATA[<h1 id="纯前端导出excel-支持多sheet页及表格样式表格合并"><a href="#纯前端导出excel-支持多sheet页及表格样式表格合并" class="headerlink" title="纯前端导出excel(支持多sheet页及表格样式表格合并)"></a>纯前端导出excel(支持多sheet页及表格样式表格合并)</h1><h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><p>一个奇怪的需求，使用纯前端进行excel导出操作，且支持多sheet页，每个sheet页分别对应一个表格，而且每个表格都需要支持表格行合并（分多级进行行合并，在内容相同则进行合并的基础上低级的列需要在高级列合并的行范围内合并）。</p><h2 id="解决过程"><a href="#解决过程" class="headerlink" title="解决过程"></a>解决过程</h2><p>一般情况下进行excel导出操作都是后端的事，这次我在网上搜索了很多方法，发现一种可以达到要求。那就是使用sheetjs进行excel导出，该js库是某公司开发完成的。但是这里又有个比较坑的点，那就是这个js库的功能并不是全都开放出来了，如果说想要修改表格的样式，如某个单元格的字体、背景色、是否居中以及行合并、列合并等样式则需要收费使用。这里我又去网上找了一遍，最后发现了一个大佬直接使用sheetjs的社区版本进行导出操作，于是我也沿用了他的方法。</p><h2 id="效果图"><a href="#效果图" class="headerlink" title="效果图"></a>效果图</h2><img src="https://m.qpic.cn/psc?/V54abhsF2OyNpg0ukoNe41vJqy49TeUf/ruAMsa53pVQWN7FLK88i5vkUtvnTxpET8hLuJKkx1fAbnKi.1G1*3R1BHCOiId1lVLXETj7NyPVf5pGvWXwN97md7AK.lAUPYT4ATCCKz*w!/b&bo=DQevAwAAAAADB4Q!&rf=viewer_4" ><center>excel导出效果图</center><h2 id="sheetjs依赖下载链接"><a href="#sheetjs依赖下载链接" class="headerlink" title="sheetjs依赖下载链接"></a>sheetjs依赖下载链接</h2><p><a href="https://pan.baidu.com/s/1sJHHnqpJPkyvR_Ctkxt_kQ">百度网盘下载链接</a><br>提取码：qb35</p><h2 id="表格合并规则生成"><a href="#表格合并规则生成" class="headerlink" title="表格合并规则生成"></a>表格合并规则生成</h2><p>在进行表格导出excel之前，需要进行合并规则生成，而且这个表格的级数不固定，因此需要先编写一个所有表格合并规则的通解生成函数。这里的合并规则是每一级的指标名称相同项进行合并，后续同一级的权重和分数合并规则与指标名称相同，低级别指标名称要在上一级指标名称的合并范围内进行合并。代码如下。</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">//zbColList指标所在列名组成的数组，arr为数组</span><span class="token keyword">function</span> <span class="token function">createRowData</span><span class="token punctuation">(</span><span class="token parameter">arr<span class="token punctuation">,</span> zbColList</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">var</span> mergeRules <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//合并规则</span>    <span class="token keyword">var</span> colRules <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//一列的合并规则</span>    <span class="token keyword">var</span> colnum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//列数</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> num <span class="token keyword">in</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    colnum<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//规则初始化</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">var</span> tmp <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j <span class="token keyword">in</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        tmp<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        rowspan<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>        colspan<span class="token operator">:</span> <span class="token number">1</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    mergeRules<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">var</span> tmp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> rowNumTmp <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//保存的合并行数</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j <span class="token keyword">in</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>zbColList<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>zbColList<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">==</span> zbColList<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">var</span> rest <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">var</span> last <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            colRules<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            rest <span class="token operator">+=</span> item<span class="token punctuation">.</span>rowspan<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> q <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> q <span class="token operator">&lt;=</span> i<span class="token punctuation">;</span> q<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            last <span class="token operator">+=</span> mergeRules<span class="token punctuation">[</span>q<span class="token punctuation">]</span><span class="token punctuation">[</span>zbColList<span class="token punctuation">[</span>zbColList<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rowspan<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> arr<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            rowNumTmp<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>rowNumTmp <span class="token operator">+</span> rest <span class="token operator">></span> last<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                colRules<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>                rowspan<span class="token operator">:</span> rowNumTmp <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span>                colspan<span class="token operator">:</span> <span class="token number">1</span>                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> k <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> rowNumTmp <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                colRules<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>                    rowspan<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>                    colspan<span class="token operator">:</span> <span class="token number">0</span>                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                rowNumTmp <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> arr<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            colRules<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>                rowspan<span class="token operator">:</span> rowNumTmp<span class="token punctuation">,</span>                colspan<span class="token operator">:</span> <span class="token number">1</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> k <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> rowNumTmp<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                colRules<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>                rowspan<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>                colspan<span class="token operator">:</span> <span class="token number">0</span>                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            rowNumTmp <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'colRules'</span><span class="token punctuation">,</span> colRules<span class="token punctuation">)</span><span class="token punctuation">;</span>            colRules<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">col<span class="token punctuation">,</span> colIndex</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                mergeRules<span class="token punctuation">[</span>colIndex<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> col<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            colRules <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            colRules<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>                rowspan<span class="token operator">:</span> rowNumTmp<span class="token punctuation">,</span>                colspan<span class="token operator">:</span> <span class="token number">1</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>rowNumTmp <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'inss'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> k <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> rowNumTmp<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                colRules<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>                rowspan<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>                colspan<span class="token operator">:</span> <span class="token number">0</span>                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            rowNumTmp <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>zbColList<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> arr<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            rowNumTmp<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> arr<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            colRules<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>                rowspan<span class="token operator">:</span> rowNumTmp<span class="token punctuation">,</span>                colspan<span class="token operator">:</span> <span class="token number">1</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> k <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> rowNumTmp<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                colRules<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>                rowspan<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>                colspan<span class="token operator">:</span> <span class="token number">0</span>                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            rowNumTmp <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            colRules<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">col<span class="token punctuation">,</span> colIndex</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                mergeRules<span class="token punctuation">[</span>colIndex<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> col<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            colRules <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            colRules<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>                rowspan<span class="token operator">:</span> rowNumTmp<span class="token punctuation">,</span>                colspan<span class="token operator">:</span> <span class="token number">1</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> k <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> rowNumTmp<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                colRules<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>                rowspan<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>                colspan<span class="token operator">:</span> <span class="token number">0</span>                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            rowNumTmp <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">var</span> tmpKeys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>mergeRules<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">var</span> tmpKey <span class="token operator">=</span> tmpKeys<span class="token punctuation">[</span>tmpKeys<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            mergeRules<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> mergeRules<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>tmpKey<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'mergeRules!'</span><span class="token punctuation">,</span> mergeRules<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> mergeRules<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="excel导出"><a href="#excel导出" class="headerlink" title="excel导出"></a>excel导出</h2><p>这里使用社区版sheetjs进行excel导出，有以下几个函数需要使用到。</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">//获取字符串长度，方便后续导出时设置每列的列宽</span><span class="token keyword">function</span> <span class="token function">getStrLength</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">var</span> len <span class="token operator">=</span> str<span class="token punctuation">.</span>length<span class="token punctuation">;</span>    <span class="token keyword">var</span> byteLen <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            byteLen <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">//ascii码大于255则为两位字符，如中文</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            byteLen<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//小于则为一位字符</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> byteLen<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">getCharCol</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">let</span> temCol <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">,</span>    s <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">,</span>    m <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>n <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    m <span class="token operator">=</span> n <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">+</span> <span class="token number">1</span>    s <span class="token operator">=</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span>m <span class="token operator">+</span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">+</span> s    n <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> m<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">26</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> s<span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">s2ab</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> ArrayBuffer <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">var</span> buf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayBuffer</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> view <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> s<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> view<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> buf<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">var</span> buf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> s<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> buf<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> buf<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">saveAs</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> fileName</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">var</span> tmpa <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    tmpa<span class="token punctuation">.</span>download <span class="token operator">=</span> fileName <span class="token operator">||</span> <span class="token string">"下载"</span><span class="token punctuation">;</span>    tmpa<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>    tmpa<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">revokeObjectURL</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// window.opener = null;  //下载完成后关闭当前窗口</span>    <span class="token comment">// window.open('', '_self');</span>    <span class="token comment">// window.close();</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//arr表格数据,rulesList合并规则列表,目前该方法仅支持表格列数小于等于26时的导出</span><span class="token keyword">function</span> <span class="token function">downloadExl</span><span class="token punctuation">(</span><span class="token parameter">arr<span class="token punctuation">,</span> rulesList</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">//深拷贝</span>    <span class="token keyword">var</span> jsonsList <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> resultList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> outputPosList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    jsonsList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>        <span class="token keyword">var</span> rules <span class="token operator">=</span> rulesList<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">var</span> jsons <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>item<span class="token punctuation">.</span>point<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">var</span> tmpdata <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span>jsons<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token keyword">var</span> keyMap <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//获取keys</span>        <span class="token keyword">var</span> colWidth <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//列宽数组</span>        jsons<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> k <span class="token keyword">in</span> tmpdata<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">var</span> q <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>            keyMap<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>            colWidth<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//列宽数组初始化</span>            <span class="token keyword">switch</span> <span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">case</span> <span class="token string">'YJZB'</span><span class="token operator">:</span>                    q <span class="token operator">=</span> <span class="token string">'一级指标'</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">case</span> <span class="token string">'YJQZ'</span><span class="token operator">:</span>                    q <span class="token operator">=</span> <span class="token string">'一级权重'</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">case</span> <span class="token string">'YJFS'</span><span class="token operator">:</span>                    q <span class="token operator">=</span> <span class="token string">'一级分数'</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">case</span> <span class="token string">'EJZB'</span><span class="token operator">:</span>                    q <span class="token operator">=</span> <span class="token string">'二级指标'</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">case</span> <span class="token string">'EJQZ'</span><span class="token operator">:</span>                    q <span class="token operator">=</span> <span class="token string">'二级权重'</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">case</span> <span class="token string">'EJFS'</span><span class="token operator">:</span>                    q <span class="token operator">=</span> <span class="token string">'二级分数'</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">case</span> <span class="token string">'SJZB'</span><span class="token operator">:</span>                    q <span class="token operator">=</span> <span class="token string">'三级指标'</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">case</span> <span class="token string">'SJQZ'</span><span class="token operator">:</span>                    q <span class="token operator">=</span> <span class="token string">'三级权重'</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">case</span> <span class="token string">'SJFS'</span><span class="token operator">:</span>                    q <span class="token operator">=</span> <span class="token string">'三级分数'</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">case</span> <span class="token string">'SIJZB'</span><span class="token operator">:</span>                    q <span class="token operator">=</span> <span class="token string">'四级指标'</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">case</span> <span class="token string">'SIJQZ'</span><span class="token operator">:</span>                    q <span class="token operator">=</span> <span class="token string">'四级权重'</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">case</span> <span class="token string">'SIJFS'</span><span class="token operator">:</span>                    q <span class="token operator">=</span> <span class="token string">'四级分数'</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">case</span> <span class="token string">'TSNKCS'</span><span class="token operator">:</span>                    q <span class="token operator">=</span> <span class="token string">'特殊内控措施'</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            jsons<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> q<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        jsons<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> k <span class="token keyword">in</span> tmpdata<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">switch</span> <span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">case</span> <span class="token string">'YJZB'</span><span class="token operator">:</span>                    jsons<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'任务名称'</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">case</span> <span class="token string">'YJQZ'</span><span class="token operator">:</span>                    jsons<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">.</span>task_name<span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">case</span> <span class="token string">'YJFS'</span><span class="token operator">:</span>                    jsons<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'评估主体'</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">case</span> <span class="token string">'EJZB'</span><span class="token operator">:</span>                    jsons<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">.</span>primary<span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">case</span> <span class="token string">'EJQZ'</span><span class="token operator">:</span>                    jsons<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'评估单位'</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">case</span> <span class="token string">'EJFS'</span><span class="token operator">:</span>                    jsons<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">.</span>unit<span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">default</span><span class="token operator">:</span>                    jsons<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> k <span class="token keyword">in</span> jsons<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">var</span> tmpWidth <span class="token operator">=</span> <span class="token function">getStrLength</span><span class="token punctuation">(</span>jsons<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> jsons<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">var</span> currentWidth <span class="token operator">=</span> <span class="token function">getStrLength</span><span class="token punctuation">(</span>jsons<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>currentWidth <span class="token operator">></span> tmpWidth<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    tmpWidth <span class="token operator">=</span> currentWidth<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> jsons<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    colWidth<span class="token punctuation">[</span>keyMap<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> tmpWidth<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">var</span> tmpdata <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        jsons<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">v<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=></span> keyMap<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">k<span class="token punctuation">,</span> j</span><span class="token punctuation">)</span> <span class="token operator">=></span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>            v<span class="token operator">:</span> v<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span>            position<span class="token operator">:</span> <span class="token punctuation">(</span>j <span class="token operator">></span> <span class="token number">25</span> <span class="token operator">?</span> <span class="token function">getCharCol</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">:</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span><span class="token number">65</span> <span class="token operator">+</span> j<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">prev<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=></span> prev<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>next<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">v<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=></span> tmpdata<span class="token punctuation">[</span>v<span class="token punctuation">.</span>position<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            v<span class="token operator">:</span> v<span class="token punctuation">.</span>v        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">var</span> outputPos <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>tmpdata<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置区域,比如表格A1到D10</span>        outputPosList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>outputPos<span class="token punctuation">)</span><span class="token punctuation">;</span>        tmpdata<span class="token punctuation">[</span><span class="token string">"!merges"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//设置行合并</span>        rules<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> k <span class="token keyword">in</span> item<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>rowspan <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>rowspan <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    tmpdata<span class="token punctuation">[</span><span class="token string">"!merges"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>                        s<span class="token operator">:</span> <span class="token punctuation">&#123;</span>                            c<span class="token operator">:</span> keyMap<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">,</span>                            r<span class="token operator">:</span> index <span class="token operator">+</span> <span class="token number">2</span>                        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>                        e<span class="token operator">:</span> <span class="token punctuation">&#123;</span>                            c<span class="token operator">:</span> keyMap<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">,</span>                            r<span class="token operator">:</span> index <span class="token operator">+</span> item<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>rowspan <span class="token operator">+</span> <span class="token number">1</span>                        <span class="token punctuation">&#125;</span>                    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> tmpdata<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>key<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">"!"</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                tmpdata<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">.</span>s <span class="token operator">=</span> <span class="token punctuation">&#123;</span>                    border<span class="token operator">:</span> <span class="token punctuation">&#123;</span>                        top<span class="token operator">:</span> <span class="token punctuation">&#123;</span>                            style<span class="token operator">:</span> <span class="token string">'thin'</span><span class="token punctuation">,</span>                            color<span class="token operator">:</span> <span class="token punctuation">&#123;</span>                                rgb<span class="token operator">:</span> <span class="token string">"000000"</span>                            <span class="token punctuation">&#125;</span>                        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>                        left<span class="token operator">:</span> <span class="token punctuation">&#123;</span>                            style<span class="token operator">:</span> <span class="token string">'thin'</span><span class="token punctuation">,</span>                            color<span class="token operator">:</span> <span class="token punctuation">&#123;</span>                                rgb<span class="token operator">:</span> <span class="token string">"000000"</span>                            <span class="token punctuation">&#125;</span>                        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>                        bottom<span class="token operator">:</span> <span class="token punctuation">&#123;</span>                            style<span class="token operator">:</span> <span class="token string">'thin'</span><span class="token punctuation">,</span>                            color<span class="token operator">:</span> <span class="token punctuation">&#123;</span>                                rgb<span class="token operator">:</span> <span class="token string">"000000"</span>                            <span class="token punctuation">&#125;</span>                        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>                        right<span class="token operator">:</span> <span class="token punctuation">&#123;</span>                            style<span class="token operator">:</span> <span class="token string">'thin'</span><span class="token punctuation">,</span>                            color<span class="token operator">:</span> <span class="token punctuation">&#123;</span>                                rgb<span class="token operator">:</span> <span class="token string">"000000"</span>                            <span class="token punctuation">&#125;</span>                        <span class="token punctuation">&#125;</span>                    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>                    alignment<span class="token operator">:</span> <span class="token punctuation">&#123;</span>                        vertical<span class="token operator">:</span> <span class="token string">"center"</span><span class="token punctuation">,</span>                        wrapText<span class="token operator">:</span> <span class="token boolean">true</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        tmpdata<span class="token punctuation">[</span><span class="token string">"!cols"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//表格列宽配置</span>        colWidth<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>            tmpdata<span class="token punctuation">[</span><span class="token string">"!cols"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>                wch<span class="token operator">:</span> item            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        resultList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>tmpdata<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> tmpWB <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        SheetNames<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        Sheets<span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    resultList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>        <span class="token keyword">var</span> sheetName <span class="token operator">=</span> <span class="token string">'Sheet'</span> <span class="token operator">+</span> <span class="token punctuation">(</span>index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//这里可以自定义sheet页的名称，但是要保证sheet页名称唯一，否则会出错</span>        tmpWB<span class="token punctuation">.</span>SheetNames<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>sheetName<span class="token punctuation">)</span><span class="token punctuation">;</span>        tmpWB<span class="token punctuation">.</span>Sheets<span class="token punctuation">[</span>sheetName<span class="token punctuation">]</span> <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> item<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>            <span class="token string">'!ref'</span><span class="token operator">:</span> outputPosList<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> outputPosList<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span>outputPosList<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token comment">//设置区域</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    tmpDown <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">s2ab</span><span class="token punctuation">(</span><span class="token constant">XLSX</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>tmpWB<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>        bookType<span class="token operator">:</span> <span class="token string">'xlsx'</span><span class="token punctuation">,</span>        bookSST<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>        type<span class="token operator">:</span> <span class="token string">'binary'</span>    <span class="token punctuation">&#125;</span> <span class="token comment">//这里的数据是用来定义导出的格式类型</span>    <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>        type<span class="token operator">:</span> <span class="token string">""</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> wopts <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        bookType<span class="token operator">:</span> <span class="token string">'xlsx'</span><span class="token punctuation">,</span>        bookSST<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>        type<span class="token operator">:</span> <span class="token string">'binary'</span><span class="token punctuation">,</span>        cellStyles<span class="token operator">:</span> <span class="token boolean">true</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token comment">//这里可以自定义导出的文件名</span>    <span class="token function">saveAs</span><span class="token punctuation">(</span>tmpDown<span class="token punctuation">,</span> <span class="token string">"评估结果."</span> <span class="token operator">+</span> <span class="token punctuation">(</span>wopts<span class="token punctuation">.</span>bookType <span class="token operator">==</span> <span class="token string">"biff2"</span> <span class="token operator">?</span> <span class="token string">"xls"</span> <span class="token operator">:</span> wopts<span class="token punctuation">.</span>bookType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="测试数据"><a href="#测试数据" class="headerlink" title="测试数据"></a>测试数据</h2><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> rows <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span>            task_name<span class="token operator">:</span> <span class="token string">'子任务1'</span><span class="token punctuation">,</span>            primary<span class="token operator">:</span> <span class="token string">'评估主体1'</span><span class="token punctuation">,</span>            unit<span class="token operator">:</span> <span class="token string">'评估单位1'</span><span class="token punctuation">,</span>            point<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span>                <span class="token constant">YJZB</span><span class="token operator">:</span> <span class="token string">'地域风险'</span><span class="token punctuation">,</span>                <span class="token constant">YJQZ</span><span class="token operator">:</span> <span class="token string">'0.25'</span><span class="token punctuation">,</span>                <span class="token constant">YJFS</span><span class="token operator">:</span> <span class="token string">'0.25'</span><span class="token punctuation">,</span>                <span class="token constant">EJZB</span><span class="token operator">:</span> <span class="token string">'境内地域'</span><span class="token punctuation">,</span>                <span class="token constant">EJQZ</span><span class="token operator">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>                <span class="token constant">EJFS</span><span class="token operator">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>                <span class="token constant">SJZB</span><span class="token operator">:</span> <span class="token string">'分公司1'</span><span class="token punctuation">,</span>                <span class="token constant">SJQZ</span><span class="token operator">:</span> <span class="token string">'0.3'</span><span class="token punctuation">,</span>                <span class="token constant">SJFS</span><span class="token operator">:</span> <span class="token string">'0.3'</span><span class="token punctuation">,</span>                <span class="token constant">SIJZB</span><span class="token operator">:</span> <span class="token string">'职工1'</span><span class="token punctuation">,</span>                <span class="token constant">SIJQZ</span><span class="token operator">:</span> <span class="token string">'0.2'</span><span class="token punctuation">,</span>                <span class="token constant">SIJFS</span><span class="token operator">:</span> <span class="token string">'0.2'</span><span class="token punctuation">,</span>                <span class="token constant">TSNKCS</span><span class="token operator">:</span> <span class="token string">'1.措施1:(权重:分数)\n2.措施2:(权重:分数)\n3.措施3:(权重:分数)'</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>                <span class="token constant">YJZB</span><span class="token operator">:</span> <span class="token string">'地域风险'</span><span class="token punctuation">,</span>                <span class="token constant">YJQZ</span><span class="token operator">:</span> <span class="token string">'0.25'</span><span class="token punctuation">,</span>                <span class="token constant">YJFS</span><span class="token operator">:</span> <span class="token string">'0.25'</span><span class="token punctuation">,</span>                <span class="token constant">EJZB</span><span class="token operator">:</span> <span class="token string">'境内地域'</span><span class="token punctuation">,</span>                <span class="token constant">EJQZ</span><span class="token operator">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>                <span class="token constant">EJFS</span><span class="token operator">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>                <span class="token constant">SJZB</span><span class="token operator">:</span> <span class="token string">'分公司1'</span><span class="token punctuation">,</span>                <span class="token constant">SJQZ</span><span class="token operator">:</span> <span class="token string">'0.3'</span><span class="token punctuation">,</span>                <span class="token constant">SJFS</span><span class="token operator">:</span> <span class="token string">'0.3'</span><span class="token punctuation">,</span>                <span class="token constant">SIJZB</span><span class="token operator">:</span> <span class="token string">'职工1'</span><span class="token punctuation">,</span>                <span class="token constant">SIJQZ</span><span class="token operator">:</span> <span class="token string">'0.2'</span><span class="token punctuation">,</span>                <span class="token constant">SIJFS</span><span class="token operator">:</span> <span class="token string">'0.2'</span><span class="token punctuation">,</span>                <span class="token constant">TSNKCS</span><span class="token operator">:</span> <span class="token string">'1.措施1:(权重:分数)\n2.措施2:(权重:分数)\n3.措施3:(权重:分数)'</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token punctuation">&#123;</span>                <span class="token constant">YJZB</span><span class="token operator">:</span> <span class="token string">'业务风险'</span><span class="token punctuation">,</span>                <span class="token constant">YJQZ</span><span class="token operator">:</span> <span class="token string">'0.25'</span><span class="token punctuation">,</span>                <span class="token constant">YJFS</span><span class="token operator">:</span> <span class="token string">'0.25'</span><span class="token punctuation">,</span>                <span class="token constant">EJZB</span><span class="token operator">:</span> <span class="token string">'境内地域'</span><span class="token punctuation">,</span>                <span class="token constant">EJQZ</span><span class="token operator">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>                <span class="token constant">EJFS</span><span class="token operator">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>                <span class="token constant">SJZB</span><span class="token operator">:</span> <span class="token string">'分公司1'</span><span class="token punctuation">,</span>                <span class="token constant">SJQZ</span><span class="token operator">:</span> <span class="token string">'0.3'</span><span class="token punctuation">,</span>                <span class="token constant">SJFS</span><span class="token operator">:</span> <span class="token string">'0.3'</span><span class="token punctuation">,</span>                <span class="token constant">SIJZB</span><span class="token operator">:</span> <span class="token string">'职工1'</span><span class="token punctuation">,</span>                <span class="token constant">SIJQZ</span><span class="token operator">:</span> <span class="token string">'0.2'</span><span class="token punctuation">,</span>                <span class="token constant">SIJFS</span><span class="token operator">:</span> <span class="token string">'0.2'</span><span class="token punctuation">,</span>                <span class="token constant">TSNKCS</span><span class="token operator">:</span> <span class="token string">'1.措施1:(权重:分数)\n2.措施2:(权重:分数)\n3.措施3:(权重:分数)'</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">]</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>            task_name<span class="token operator">:</span> <span class="token string">'子任务2'</span><span class="token punctuation">,</span>            primary<span class="token operator">:</span> <span class="token string">'评估主体2'</span><span class="token punctuation">,</span>            unit<span class="token operator">:</span> <span class="token string">'评估单位2'</span><span class="token punctuation">,</span>            point<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span>                <span class="token constant">YJZB</span><span class="token operator">:</span> <span class="token string">'地域风险'</span><span class="token punctuation">,</span>                <span class="token constant">YJQZ</span><span class="token operator">:</span> <span class="token string">'0.25'</span><span class="token punctuation">,</span>                <span class="token constant">YJFS</span><span class="token operator">:</span> <span class="token string">'0.25'</span><span class="token punctuation">,</span>                <span class="token constant">EJZB</span><span class="token operator">:</span> <span class="token string">'境内地域'</span><span class="token punctuation">,</span>                <span class="token constant">EJQZ</span><span class="token operator">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>                <span class="token constant">EJFS</span><span class="token operator">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>                <span class="token constant">SJZB</span><span class="token operator">:</span> <span class="token string">'分公司1'</span><span class="token punctuation">,</span>                <span class="token constant">SJQZ</span><span class="token operator">:</span> <span class="token string">'0.3'</span><span class="token punctuation">,</span>                <span class="token constant">SJFS</span><span class="token operator">:</span> <span class="token string">'0.3'</span><span class="token punctuation">,</span>                <span class="token constant">SIJZB</span><span class="token operator">:</span> <span class="token string">'职工1'</span><span class="token punctuation">,</span>                <span class="token constant">SIJQZ</span><span class="token operator">:</span> <span class="token string">'0.2'</span><span class="token punctuation">,</span>                <span class="token constant">SIJFS</span><span class="token operator">:</span> <span class="token string">'0.2'</span><span class="token punctuation">,</span>                <span class="token constant">TSNKCS</span><span class="token operator">:</span> <span class="token string">'1.措施1:(权重:分数)\n2.措施2:(权重:分数)\n3.措施3:(权重:分数)'</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>                <span class="token constant">YJZB</span><span class="token operator">:</span> <span class="token string">'地域风险'</span><span class="token punctuation">,</span>                <span class="token constant">YJQZ</span><span class="token operator">:</span> <span class="token string">'0.25'</span><span class="token punctuation">,</span>                <span class="token constant">YJFS</span><span class="token operator">:</span> <span class="token string">'0.25'</span><span class="token punctuation">,</span>                <span class="token constant">EJZB</span><span class="token operator">:</span> <span class="token string">'境内地域'</span><span class="token punctuation">,</span>                <span class="token constant">EJQZ</span><span class="token operator">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>                <span class="token constant">EJFS</span><span class="token operator">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>                <span class="token constant">SJZB</span><span class="token operator">:</span> <span class="token string">'分公司1'</span><span class="token punctuation">,</span>                <span class="token constant">SJQZ</span><span class="token operator">:</span> <span class="token string">'0.3'</span><span class="token punctuation">,</span>                <span class="token constant">SJFS</span><span class="token operator">:</span> <span class="token string">'0.3'</span><span class="token punctuation">,</span>                <span class="token constant">SIJZB</span><span class="token operator">:</span> <span class="token string">'职工1'</span><span class="token punctuation">,</span>                <span class="token constant">SIJQZ</span><span class="token operator">:</span> <span class="token string">'0.2'</span><span class="token punctuation">,</span>                <span class="token constant">SIJFS</span><span class="token operator">:</span> <span class="token string">'0.2'</span><span class="token punctuation">,</span>                <span class="token constant">TSNKCS</span><span class="token operator">:</span> <span class="token string">'1.措施1:(权重:分数)\n2.措施2:(权重:分数)\n3.措施3:(权重:分数)'</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">]</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h2><p>最后，还需要对其进行应用，编写一个函数来测试一下是否能成功导出</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">download</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">var</span> ruleList<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    rows<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span>index</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span>        ruleList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">createRowData</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>point<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'YJZB'</span><span class="token punctuation">,</span><span class="token string">'EJZB'</span><span class="token punctuation">,</span><span class="token string">'SJZB'</span><span class="token punctuation">,</span><span class="token string">'SIJZB'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//这里使用枚举的方式传入了需要合并的列名，实际应用过程中可按一定规律自动传入</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">downloadExl</span><span class="token punctuation">(</span>rows<span class="token punctuation">,</span>ruleList<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>进行纯前端的excel导出时，使用了sheetjs进行导出。首先进行表格合并规则的生成，生成后，将表格数据处理成sheetjs导出所需要的数据格式，之后进行表格样式、行合并、列合并等配置后导出excel。</p>]]></content>
      
      
      
        <tags>
            
            <tag> -sheetjs -excel导出 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>解决子组件页面重新加载问题</title>
      <link href="2021/08269510.html"/>
      <url>2021/08269510.html</url>
      
        <content type="html"><![CDATA[<h1 id="解决子组件页面重新加载问题"><a href="#解决子组件页面重新加载问题" class="headerlink" title="解决子组件页面重新加载问题"></a>解决子组件页面重新加载问题</h1><p>进入二级界面，再退出二级界面，然后再进入时，页面不会重新加载数据。<br>这个时候需要使用v-if控制二级界面（弹框）是否加载，在进入时使他的v-if设置为true,退出时将他的v-if设置为false,这个操作将会使该二级界面组件从create到destroy走完整个生命周期。再次进入时界面重新从created生命周期开始。只需要将数据加载放在created里即可完成数据重新加载。</p>]]></content>
      
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>移动端隐藏滚动条</title>
      <link href="2021/0826491.html"/>
      <url>2021/0826491.html</url>
      
        <content type="html"><![CDATA[<h1 id="移动端隐藏滚动条"><a href="#移动端隐藏滚动条" class="headerlink" title="移动端隐藏滚动条"></a>移动端隐藏滚动条</h1><p>移动端中设置整个页面宽高分别为100%,页面溢出部分设置为滚动（scroll），设置滚动条样式宽高为0。代码如下所示</p><pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token selector">html,body</span><span class="token punctuation">&#123;</span>   <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>   <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>    <span class="token property">overflow</span><span class="token punctuation">:</span> scroll<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token selector">html::-webkit-scrollbar, body::-webkit-scrollbar</span><span class="token punctuation">&#123;</span>  <span class="token property">width</span><span class="token punctuation">:</span>0px<span class="token punctuation">;</span>  <span class="token property">height</span><span class="token punctuation">:</span>0px<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token selector">body</span><span class="token punctuation">&#123;</span>  <span class="token property">margin</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这样移动端右侧滚动条即可隐藏。</p>]]></content>
      
      
      
        <tags>
            
            <tag> css </tag>
            
            <tag> 移动端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>opacity与z-index的关系</title>
      <link href="2021/082624569.html"/>
      <url>2021/082624569.html</url>
      
        <content type="html"><![CDATA[<h1 id="opacity与z-index的关系"><a href="#opacity与z-index的关系" class="headerlink" title="opacity与z-index的关系"></a>opacity与z-index的关系</h1><h2 id="问题发现"><a href="#问题发现" class="headerlink" title="问题发现"></a>问题发现</h2><p>在使用 opacity 属性来实现页面整体透明的时候，发现了一个问题。如果两个层发生了重叠，使用了 opacity 属性并且属性值小于1的层，会覆盖掉后面的层。于是动手做了个实验，来验证 opacity 的层次。 </p><p>网页中的层叠规律是这样的：如果两个层都没有定义 position 属性为 absolute 或者 relative 属性，哪个层的HTML代码放在后面，哪个层就显示在上面。如果指定了 position 属性，并且设置了 z-index 属性，谁的值大，谁就在上面。 </p><h2 id="Opacity-属性引发的层叠问题"><a href="#Opacity-属性引发的层叠问题" class="headerlink" title="Opacity 属性引发的层叠问题"></a>Opacity 属性引发的层叠问题</h2><p>而对于没有激活 z-index 的普通层来说，如果那个层使用了属性值小于1的 opacity 属性，哪个层就会显示在上面。我们做一个Demo。代码如下： </p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span> <span class="token punctuation">></span></span>带有 opacity 的层叠问题<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">         <span class="token selector">html</span><span class="token punctuation">&#123;</span>            <span class="token property">padding</span><span class="token punctuation">:</span>40px<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>         <span class="token selector">div</span><span class="token punctuation">&#123;</span>            <span class="token property">width</span><span class="token punctuation">:</span>100px<span class="token punctuation">;</span>            <span class="token property">height</span><span class="token punctuation">:</span>100px<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>         <span class="token selector">#a</span><span class="token punctuation">&#123;</span>            <span class="token property">background</span><span class="token punctuation">:</span>red<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>         <span class="token selector">#b</span><span class="token punctuation">&#123;</span>            <span class="token property">background</span><span class="token punctuation">:</span>blue<span class="token punctuation">;</span>            <span class="token property">margin-left</span><span class="token punctuation">:</span>20px<span class="token punctuation">;</span>            <span class="token property">margin-top</span><span class="token punctuation">:</span>-80px<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>         <span class="token selector">#c</span><span class="token punctuation">&#123;</span>            <span class="token property">background</span><span class="token punctuation">:</span>green<span class="token punctuation">;</span>            <span class="token property">margin-left</span><span class="token punctuation">:</span>40px<span class="token punctuation">;</span>            <span class="token property">margin-top</span><span class="token punctuation">:</span>-80px<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>     </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>a<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>b<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>c<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>保存为 html 文件打开之后，可以看到正常的次序 </p><img src="http://www.bugshouji.com/attachment/1708/thread/26_13_f4f558c097ea22d.png" width="50%"><center>正常的层叠</center> <p>这时候，我们为 #a 加上属性 opacity：0.9 神奇的事情发生了，它覆盖了另外两个层：<br><img src="http://www.bugshouji.com/attachment/1708/thread/26_13_e22583c1c367ea6.png" width="50%"></p><center>加上小于1的 opacity 之后的层叠</center><p>只有当为另一个层（例如：#c）也设置一个小于1的opacity值（例如：0.8）之后，后面的 #c 才能安装正常的规则覆盖在 #a 上面。 </p><img src="http://www.bugshouji.com/attachment/1708/thread/26_13_33f3420f05367e2.png" width="50%"><center>同时为另一个层赋值 opacity </center><p>这样，增加了小于1的 opacity 属性的层，升高了一个层次。至于里面的科学原理，我没有想明白，或许也可能是一个小BUG。但是有时候这种情况是我们不希望发生的。 </p><h2 id="通过定义-position-的属性来解决问题"><a href="#通过定义-position-的属性来解决问题" class="headerlink" title="通过定义 position 的属性来解决问题"></a>通过定义 position 的属性来解决问题</h2><p>那么如何来解决这个问题呢？前面也说过了，正常的情况下，指定了 position 并且指定了 z-index 值的层，拥有比普通层更高的层次，那么指定 opacity 的层和指定了 position 的层相比呢？我们对 #b 加上 position：relative 看看。这时候的样式代码如下： </p><pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token selector">#a</span><span class="token punctuation">&#123;</span>    <span class="token property">background</span><span class="token punctuation">:</span>red<span class="token punctuation">;</span>    <span class="token property">opacity</span><span class="token punctuation">:</span>0.9<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token selector">#b</span><span class="token punctuation">&#123;</span>    <span class="token property">background</span><span class="token punctuation">:</span>blue<span class="token punctuation">;</span>    <span class="token property">margin-left</span><span class="token punctuation">:</span>20px<span class="token punctuation">;</span>    <span class="token property">margin-top</span><span class="token punctuation">:</span>-80px<span class="token punctuation">;</span>    <span class="token property">position</span><span class="token punctuation">:</span>relative<span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token selector">#c</span><span class="token punctuation">&#123;</span>    <span class="token property">background</span><span class="token punctuation">:</span>green<span class="token punctuation">;</span>    <span class="token property">margin-left</span><span class="token punctuation">:</span>40px<span class="token punctuation">;</span>    <span class="token property">margin-top</span><span class="token punctuation">:</span>-80px<span class="token punctuation">;</span>    <span class="token property">opacity</span><span class="token punctuation">:</span>0.8<span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>保存刷新后，看到效果是这样的： </p><img src="http://www.bugshouji.com/attachment/1708/thread/26_13_749c60f6457d15e.png" width="50%"><center>对中层使用了 position 属性之后的层叠效果 </center><p>也就是说，对层使用 position 属性的 relative 之后，可以使其层次和 opacity 相同，这样之后，按照正常的排序进行层叠显示（在后面的实验中，我对 absolute 属性值也做了测试，结果和 relative 属性值表现的相同）。当我们取消了 #c 的 opacity 属性之后，我们可以看到，#c 被排在了最下面。 </p><img src="http://www.bugshouji.com/attachment/1708/thread/26_13_0ddc1cc3c1339e5.png" width="50%"><center>对底层取消 opacity 属性之后的效果</center> <p>还没有完，之前只是对 #b 激活了 position：relative 属性，还没有使用 z-index。我们对 #b 进行了 z-index 的设置（例如：100），很显然的，#b 成为了最顶层。 </p><img src="http://www.bugshouji.com/attachment/1708/thread/26_13_0bdb9c1a9d22dfb.png" width="50%"><center>对中间层设置 z-index 的效果 </center><h2 id="层叠问题总结"><a href="#层叠问题总结" class="headerlink" title="层叠问题总结"></a>层叠问题总结</h2><p>使用了 position 属性值为 absolute、relative 的层，将会比普通层更高层次。使用了小于1的 opacity 属性的层，也比普通层更高层次并且和指定 position 的层同层，但是不支持 z-index 属性，所以指定 position 的层，可以使用 z-index 属性，来覆盖带有小于1的 opacity 属性的层。” </p><p>转自：<a href="http://www.cnblogs.com/leolovexx/p/5440061.html#3514684">http://www.cnblogs.com/leolovexx/p/5440061.html#3514684</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> css </tag>
            
            <tag> html </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>解决echarts多次setOption出现数据错误问题</title>
      <link href="2021/07066401.html"/>
      <url>2021/07066401.html</url>
      
        <content type="html"><![CDATA[<h1 id="解决echarts多次setOption出现数据错误问题"><a href="#解决echarts多次setOption出现数据错误问题" class="headerlink" title="解决echarts多次setOption出现数据错误问题"></a>解决echarts多次setOption出现数据错误问题</h1><p>在每次使用setOption之前先清空画布，</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">myChart<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>myChart<span class="token punctuation">.</span><span class="token function">setOption</span><span class="token punctuation">(</span>option<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>当需要使用到echarts数据变化过渡动画时不能清空画布，这时需要先判断在哪个阶段不需要清空画布，在画布产生某些属性show变化时再清空画布，可以避免数据出错问题。</p>]]></content>
      
      
      
        <tags>
            
            <tag> echarts </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>解决js小数计算精度问题</title>
      <link href="2021/070135023.html"/>
      <url>2021/070135023.html</url>
      
        <content type="html"><![CDATA[<h1 id="解决js小数计算精度问题"><a href="#解决js小数计算精度问题" class="headerlink" title="解决js小数计算精度问题"></a>解决js小数计算精度问题</h1><p>当进行js小数计算时可能会出现精度问题，如</p><blockquote><p>6.7 + 0.1 != 6.8</p></blockquote><p>而是等于6.800000005,这时候需要将结果进行乘10的n次幂（n为小数位数）再除以10的n次幂</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token function-variable function">formatNum</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">f<span class="token punctuation">,</span> digit</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">var</span> m <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> digit<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//Math.pow用于计算一个数的n次幂</span>    <span class="token keyword">return</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>f <span class="token operator">*</span> m<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">/</span> m<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">var</span> num1 <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">;</span><span class="token keyword">var</span> num2 <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num1<span class="token operator">+</span>num2<span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">formatNum</span><span class="token punctuation">(</span>num1 <span class="token operator">+</span> num2<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android gradle组件下载失败解决方法</title>
      <link href="2021/050536477.html"/>
      <url>2021/050536477.html</url>
      
        <content type="html"><![CDATA[<h1 id="Android-gradle组件下载失败解决方法"><a href="#Android-gradle组件下载失败解决方法" class="headerlink" title="Android gradle组件下载失败解决方法"></a>Android gradle组件下载失败解决方法</h1><p>1.下载对应网站证书<br>2.将下载地址中的https改为http，当无网站授权证书时，https访问会被拒绝<br>3.同时使用华为云仓库镜像进行组件下载<br>默认访问地址为https，改为http，因为as没有证书会被拒绝访问。<br>同时使用华为云仓库。gradle配置如下：</p><pre class="line-numbers language-none"><code class="language-none">buildscript &#123;    repositories &#123;        maven &#123; url &#39;http:&#x2F;&#x2F;mirrors.huaweicloud.com&#x2F;repository&#x2F;maven&#x2F;&#39; &#125;    &#125;    dependencies &#123;        classpath &#39;com.android.tools.build:gradle:3.0.1&#39;    &#125;&#125;allprojects &#123;    repositories &#123;        maven &#123; url &#39;http:&#x2F;&#x2F;mirrors.huaweicloud.com&#x2F;repository&#x2F;maven&#x2F;&#39; &#125;        maven &#123; url &quot;http:&#x2F;&#x2F;jitpack.io&quot; &#125;    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> bug解决 </tag>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
